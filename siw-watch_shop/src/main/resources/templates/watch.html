<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="fragments/layout.html :: base(${watch?.name + ' - WatchLux' ?: 'Orologio - WatchLux'}, ~{::contenuto})">
<head>
    <title th:text="${watch?.name + ' - WatchLux' ?: 'Orologio - WatchLux'}">Orologio - WatchLux</title>
</head>
<body>
    <!-- Contenuto specifico del dettaglio orologio -->
    <div th:fragment="contenuto">
        
        <!-- Breadcrumb -->
        <nav class="breadcrumb">
            <a th:href="@{/}" class="breadcrumb-link">
                <i class="material-icons">home</i>
                Home
            </a>
            <span class="breadcrumb-separator">></span>
            <a th:href="@{/watches}" class="breadcrumb-link">Orologi</a>
            <span class="breadcrumb-separator">></span>
            <span class="breadcrumb-current" th:text="${watch?.name ?: 'Orologio'}">Orologio</span>
        </nav>
        
        <!-- Contenuto principale -->
        <div th:if="${watch}" class="product-container">
            <div class="product-detail">

                        <!-- Colonna sinistra: Immagine + Garanzie -->
                <div class="product-left-column">
                    <!-- Singola immagine -->
                    <img th:src="@{'/images/' + ${watch.imagePath}}" 
                        alt="Watch image" 
                        class="watch-image"
                        th:if="${watch.imagePath != null}" />

                    <!-- Immagine placeholder se non c'è immagine -->
                    <div th:unless="${watch.imagePath != null}" class="no-image">
                        <p>Nessuna immagine disponibile</p>
                    </div>
                    
                    <!-- Caratteristiche spostate qui -->
                    <div class="product-features">
                        <h3>Garanzie Incluse</h3>
                        <ul class="features-list">
                            <li>
                                <i class="material-icons">shield</i>
                                Garanzia ufficiale 2 anni
                            </li>
                            <li>
                                <i class="material-icons">verified</i>
                                Certificato di autenticità 
                            </li>
                            <li>
                                <i class="material-icons">local_shipping</i>
                                Spedizione assicurata gratuita
                            </li>
                            <li>
                                <i class="material-icons">assignment_return</i>
                                Reso gratuito entro 30 giorni
                            </li>
                        </ul>
                    </div>
                </div>

                
                <!-- Informazioni Prodotto -->
                <div class="product-info">
                    <div class="product-header">
                        <p class="product-brand" th:text="${watch.brand} + '  ' + ${watch.name} + '  -  ' + ${watch.year}">Marca</p>
                    </div>
                    
                    
                    <div class="product-price">
                        <span class="price-currency">€</span>
                        <span class="price-amount" th:text="${#numbers.formatDecimal(watch.price, 1, 2)}">0.00</span>
                    </div>
                    
                    <!-- Azioni -->
                    <div class="product-actions">
                        <div th:if="${userDetails == null or userDetails.role.name() == 'USER'}">
                            <form th:action="@{/currentOrder/add/{id}(id=${watch.id})}" method="post" class="add-to-cart-form">
                                <button type="submit" class="btn-add-cart">
                                    <i class="material-icons">shopping_cart</i>
                                    Aggiungi al Carrello
                                </button>
                            </form>
                        </div>
                        <div th:if="${isAuthenticated and userDetails != null and userDetails.role.name() == 'ADMIN'}">
                            <form th:action="@{'/admin/watch/' + ${watch.id} + '/deactivate'}" method="post" class="add-to-cart-form">
                                <button type="submit" class="btn-add-cart">
                                    <i class="material-icons">shopping_cart</i>
                                    Rimuovi orologio dal listino
                                </button>
	                            </form>
	                        </div>
	                </div>
	                
               </div>
                	
                	
            </div>
        </div>
        
        
        <!-- Sezione Recensioni Semplificata da aggiungere in watch.html dopo il product-container -->
		<!-- Sezione Recensioni Semplificata -->
        <div class="reviews-summary-section">
            <div class="reviews-summary-card">
                <div class="rating-display">
                    <div class="rating-stars">
                        <span class="stars-background">★★★★★</span>
                        <span class="stars-filled" th:style="'width: ' + ${(watch.averageRating != null) ? (watch.averageRating / 5 * 100) : 0} + '%'">★★★★★</span>
                    </div>
                    <span th:if="${watch.averageRating != null and watch.averageRating > 0}" class="rating-number" th:text="${#numbers.formatDecimal(watch.averageRating, 1, 1)}">0.0</span>
                </div>
                
                <div class="reviews-info">
                    <span class="reviews-count" th:text="${(watch.ratingCount ?: 0)} + ' recensioni'">0 recensioni</span>
                    <a th:href="@{'/watch/' + ${watch.id} + '/reviews'}" class="view-reviews-btn">
                        Vedi tutte le recensioni
                        <i class="material-icons">arrow_forward</i>
                    </a>
                </div>
            </div>
        </div>
        
        
        <!-- Messaggio se l'orologio non esiste -->
        <div th:unless="${watch}" class="not-found-container">
            <div class="not-found-content">
                <div class="not-found-icon">⌚</div>
                <h2>Orologio non trovato</h2>
                <p>L'orologio che stai cercando non esiste o non è più disponibile.</p>
                <a th:href="@{/watches}" class="btn-back">
                    <i class="material-icons">arrow_back</i>
                    Torna agli Orologi
                </a>
            </div>
        </div>
        
        
        
        
    </div>
</body>
</html>