<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout.html :: base('Carrello - WatchLux', ~{::contenuto})}">
<head>
    <title>Carrello - WatchLux</title>
</head>
<body>
    <div th:fragment="contenuto">
        <div style="max-width: 800px; margin: 0 auto; padding: 2rem; background: #fafafa; font-family: Arial, sans-serif; min-height: 60vh;">
            
            <!-- Header -->
            <div style="text-align: center; margin-bottom: 3rem; padding: 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px; color: white; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
                <h1 style="font-size: 2.2rem; margin: 0; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                     Il mio Carrello
                </h1>
            </div>

            <!-- Carrello vuoto -->
            <div th:if="${#lists.isEmpty(orderLines)}" style="text-align: center; padding: 4rem 2rem; background: white; border-radius: 16px; border: 1px solid #e5e7eb; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                <div style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.7;">üõí</div>
                <h2 style="font-size: 1.5rem; color: #374151; margin: 0 0 1rem 0; font-weight: 600;">Il tuo carrello √® vuoto</h2>
                <p style="color: #6b7280; margin: 0 0 2rem 0; line-height: 1.6;">Aggiungi alcuni orologi per iniziare i tuoi acquisti</p>
                <a th:href="@{/watches}" style="display: inline-block; background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; padding: 1rem 2rem; border-radius: 8px; text-decoration: none; font-weight: 600; box-shadow: 0 4px 12px rgba(59,130,246,0.3); transition: all 0.2s;">
                     Esplora Orologi
                </a>
            </div>

            <!-- Carrello con prodotti -->
            <div th:if="${!#lists.isEmpty(orderLines)}">
                
                <!-- Lista prodotti -->
                <div style="margin-bottom: 2rem;">
                    <div th:each="orderLine : ${orderLines}" style="position: relative; display: flex; align-items: center; padding: 1.5rem; margin-bottom: 1rem; background: white; border: 1px solid #e5e7eb; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: all 0.2s;">
                        
                        <!-- Pulsante Rimozione (in alto a destra) -->
                        <form th:action="@{/currentOrder/remove/{id}(id=${orderLine.id})}" 
                              method="post" 
                              style="position: absolute; top: 8px; right: 8px; z-index: 10;">
                            <button type="submit" 
                                    style="width: 28px; height: 28px; background: linear-gradient(135deg, #ef4444, #dc2626); border: none; border-radius: 6px; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; transition: all 0.2s; box-shadow: 0 2px 8px rgba(239,68,68,0.3);"
                                    onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 12px rgba(239,68,68,0.5)';"
                                    onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(239,68,68,0.3)';">
                                ‚úï
                            </button>
                        </form>
                        
                        <!-- Immagine prodotto -->
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #f3f4f6, #e5e7eb); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 2rem; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);">
                            ‚åö
                        </div>
                        
                        <!-- Dettagli prodotto -->
                        <div style="flex: 1; padding-right: 2rem;">
                            <h3 style="font-size: 1.125rem; font-weight: 600; margin: 0 0 0.5rem 0;">
                                <a th:href="@{'/watch/' + ${orderLine.watch.id}}" 
                                   th:text="${orderLine.watch.name}"
                                   style="color: #1a202c; text-decoration: none;">
                                    Nome Orologio
                                </a>
                            </h3>
                            
                            <div th:if="${orderLine.watch.brand}" style="color: #718096; font-size: 0.875rem; margin-bottom: 0.25rem;">
                                <span th:text="${orderLine.watch.brand}">Marca</span>
                            </div>
                            
                            <div style="color: #718096; font-size: 0.875rem;">
                                Quantit√†: <span th:text="${orderLine.quantity}">1</span>
                            </div>
                        </div>
                        
                        <!-- Prezzo -->
                        <div style="text-align: right; min-width: 100px;">
                            <div style="color: #6b7280; font-size: 0.875rem;">
                                ‚Ç¨<span th:text="${#numbers.formatDecimal(orderLine.watch.price, 0, 'COMMA', 2, 'POINT')}">0,00</span>
                            </div>
                            <div style="font-size: 1.25rem; font-weight: 700; color: #059669; background: linear-gradient(135deg, #10b981, #059669); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                                ‚Ç¨<span th:text="${#numbers.formatDecimal(orderLine.watch.price * orderLine.quantity, 0, 'COMMA', 2, 'POINT')}">0,00</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Riepilogo -->
                <div style="background: linear-gradient(135deg, #f8fafc, #f1f5f9); border: 1px solid #cbd5e1; border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
                    <h3 style="margin: 0 0 1rem 0; color: #334155; font-size: 1.1rem; font-weight: 600;">üìã Riepilogo Ordine</h3>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; padding: 0.5rem 0; color: #475569;">
                        <span>Articoli:</span>
                        <span th:text="${#lists.size(orderLines)}">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; padding: 0.5rem 0; color: #475569;">
                        <span>Spedizione:</span>
                        <span style="color: #059669; font-weight: 600;">Gratuita</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; border-top: 2px solid #cbd5e1; margin-top: 1rem; padding-top: 1rem; font-weight: 700; font-size: 1.3rem; color: #1e293b;">
                        <span>Totale:</span>
                        <span style="color: #059669;">
                            ‚Ç¨<span th:text="${#numbers.formatDecimal(currentOrder.totalPrice, 0, 'COMMA', 2, 'POINT')}">0,00</span>
                        </span>
                    </div>
                </div>
                
                <!-- Azioni -->
                <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                    <form th:action="@{/currentOrder}" method="post" style="display: inline;">
                        <button type="submit" style="background: linear-gradient(135deg, #059669, #047857); color: white; padding: 1rem 2rem; border-radius: 10px; border: none; font-weight: 600; cursor: pointer; font-size: 1rem; box-shadow: 0 4px 12px rgba(5,150,105,0.3); transition: all 0.2s;">
                            ‚úÖ Conferma Ordine
                        </button>
                    </form>
                    
                    <a th:href="@{/watches}" style="background: white; color: #374151; padding: 1rem 2rem; border-radius: 10px; text-decoration: none; font-weight: 600; border: 2px solid #d1d5db; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.2s;">
                        üõçÔ∏è Continua Shopping
                    </a>
                </div>
            </div>
            
        </div>
    </div>
</body>
</html>