<!DOCTYPE html>
<html lang="it" xmlns:th="http://www.thymeleaf.org" 
      th:replace="~{fragments/layout :: base(~{::title}, ~{::main})}">
<head>
    <title>Orologi - TimeCraft</title>
</head>
<body>
    <main>
        <div class="watches-container">
            <!-- Header della pagina -->
            
            <div th:if="${isAdmin}" class="admin-actions">
                        <a th:href="@{/admin/formNewWatch}" class="btn-add"> Aggiungi Orologio</a>
                    </div>
                    <p th:if="${searchQuery}" class="search-info">
                    Risultati per: <span class="search-term" th:text="${searchQuery}"></span>
                </p>
                    
            

            <!-- Filtro Brand -->
            <div class="categories-filter">
                <a th:href="@{/watches}" 
                   class="filter-btn" 
                   th:classappend="${selectedBrand == null} ? 'active' : ''">
                   Tutti i Brand
                </a>
                <a th:each="brand : ${brands}" 
                   th:href="@{/watches/brand/{brand}(brand=${brand})}" 
                   class="filter-btn"
                   th:classappend="${selectedBrand == brand} ? 'active' : ''"
                   th:text="${brand}">Brand</a>
            </div>

            <!-- Griglia orologi -->
            <div class="watches-grid" th:if="${watches} and !${#lists.isEmpty(watches)}">
                <div class="watch-card" th:each="watch : ${watches}">
                    <a th:href="@{/watch/{id}(id=${watch.id})}" class="watch-link">
                        <!-- Immagine orologio -->
                        <div class="watch-image">
                            <img th:if="${watch.imagePath}" 
                                 th:src="@{/images/{filename}(filename=${watch.imagePath})}" 
                                 th:alt="${watch.name}"
                                 class="watch-img">
                            <div th:unless="${watch.imagePath}" class="watch-placeholder">
                                <span><img th:src="@{/images/icons/watch.png}" 
                             style="width: 60px !important; height: 60px !important;"></span>
                            </div>
                            
                            <!-- Badge disponibilità -->
                            <span th:if="${watch.availability}" class="availability-badge">Disponibile</span>
                            <span th:unless="${watch.availability}" class="availability-badge sold-out">Non disponibile</span>
                        </div>

                        <!-- Info orologio -->
                        <div class="watch-info">
                            <div class="watch-name" th:text="${watch.brand} + ' - ' + ${watch.name}">Nome Orologio</div>
                            
                            
                            <!-- Prezzo -->
                            <div class="watch-price">
                                <span class="price-amount">€<span th:text="${#numbers.formatDecimal(watch.price, 0, 2)}">999.00</span></span>
                            </div>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Stato vuoto -->
            <div class="empty-state" th:if="${watches == null or #lists.isEmpty(watches)}">
                <div class="empty-icon"></div>
                <h3>Nessun Orologio Trovato</h3>
                <p th:if="${searchQuery}">
                    Non abbiamo trovato orologi corrispondenti a "<span th:text="${searchQuery}"></span>"
                </p>
                <p th:unless="${searchQuery}">
                    La collezione è temporaneamente vuota. Torna presto per scoprire le nostre novità!
                </p>
                <a th:href="@{/watches}" class="btn btn-primary" th:if="${searchQuery}">
                    Vedi Tutti gli Orologi
                </a>
            </div>
        </div>
    </main>
</body>
</html>