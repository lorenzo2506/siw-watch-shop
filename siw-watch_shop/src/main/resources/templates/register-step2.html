<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="fragments/layout.html :: base(#{Registrazione Step 2 - WatchLux}, ~{::contenuto})">
<head>
    <title>Registrazione Step 2 - WatchLux</title>
</head>
<body>
    <!-- Contenuto specifico della registrazione step 2 -->
    <div th:fragment="contenuto">
        <section class="form-container">
            <div class="form-wrapper">
                <!-- Header con progress -->
                <div class="registration-header">
                    <h1 class="form-title">
                        <i class="material-icons">person_add</i>
                        Registrazione
                    </h1>
                    
                    <div class="progress-bar">
                        <div class="step completed">
                            <span class="step-number">
                                <i class="material-icons">check</i>
                            </span>
                            <span class="step-label">Dati Personali</span>
                        </div>
                        <div class="step-connector completed"></div>
                        <div class="step active">
                            <span class="step-number">2</span>
                            <span class="step-label">Username</span>
                        </div>
                    </div>
                    
                    <p class="step-description">Ultimo passaggio: scegli il tuo username univoco</p>
                </div>
                
                <!-- Info email confermata -->
                <div class="info-box">
                    <div class="info-content">
                        <i class="material-icons">check_circle</i>
                        <div>
                            <strong>Email confermata:</strong>
                            <span th:text="${credentials.email}">email@esempio.com</span>
                        </div>
                    </div>
                </div>
                
                <!-- Form Step 2 -->
                <form th:action="@{/register/step2}" method="post" th:object="${credentials}" class="luxury-form">
                    
                    <!-- Username -->
                    <div class="form-group">
                        <label for="username" class="form-label">
                            <i class="material-icons">alternate_email</i>
                            Username
                        </label>
                        <input type="text" 
                               th:field="*{username}" 
                               id="username" 
                               class="form-input" 
                               placeholder="es. mario_rossi"
                               required>
                        
                        <!-- Errore username esistente -->
                        <div th:if="${usernameExists}" class="error-text">
                            <i class="material-icons">error</i>
                            <span th:text="${usernameExists}">Questo username è già in uso</span>
                        </div>
                        
                        <small class="form-hint">
                            <i class="material-icons">info</i>
                            L'username deve essere univoco e può contenere lettere, numeri e underscore
                        </small>
                    </div>
                    
                    <!-- Azioni -->
                    <div class="form-actions">
                        <button type="submit" class="btn-success">
                            <i class="material-icons">check</i>
                            Completa Registrazione
                        </button>
                        <a th:href="@{/register/cancel}" class="btn-secondary">
                            <i class="material-icons">close</i>
                            Annulla
                        </a>
                    </div>
                </form>
            </div>
        </section>
    </div>
</body>
</html>