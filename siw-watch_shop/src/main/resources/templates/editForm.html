<!DOCTYPE html>
<html lang="it" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modifica Recensione</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
</head>
<body>
    <!-- Header -->
    <header th:replace="~{fragments/header :: header}"></header>

    <div class="edit-form-container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb">
            <a th:href="@{/}">Home</a>
            <span>›</span>
            <a th:href="@{/watches}">Orologi</a>
            <span>›</span>
            <a th:href="@{/watch/{id}/reviews(id=${review.watch.id})}">Recensioni</a>
            <span>›</span>
            <span>Modifica</span>
        </nav>

        <!-- Header della pagina -->
        <div class="edit-header">
            <h1>Modifica la tua Recensione</h1>
            <div class="watch-reference">
                <span class="watch-info">
                    <span class="watch-brand" th:text="${review.watch.brand}">Brand</span>
                    <span class="watch-name" th:text="${review.watch.name}">Nome Orologio</span>
                </span>
            </div>
        </div>

        <!-- Form di modifica -->
        <div class="edit-form-card">
            <form th:action="@{/watch/{watchId}/review/{reviewId}/editForm(watchId=${review.watch.id}, reviewId=${review.id})}" 
                  th:object="${review}" method="post" class="edit-review-form">
                
                <!-- Rating -->
                <div class="form-group">
                    <label for="star_rating">Valutazione *</label>
                    <div class="rating-input">
                        <input type="radio" id="star5" name="star_rating" value="5" th:field="*{star_rating}">
                        <label for="star5" class="star-label">★</label>
                        <input type="radio" id="star4" name="star_rating" value="4" th:field="*{star_rating}">
                        <label for="star4" class="star-label">★</label>
                        <input type="radio" id="star3" name="star_rating" value="3" th:field="*{star_rating}">
                        <label for="star3" class="star-label">★</label>
                        <input type="radio" id="star2" name="star_rating" value="2" th:field="*{star_rating}">
                        <label for="star2" class="star-label">★</label>
                        <input type="radio" id="star1" name="star_rating" value="1" th:field="*{star_rating}">
                        <label for="star1" class="star-label">★</label>
                    </div>
                    <span th:if="${#fields.hasErrors('star_rating')}" 
                          th:errors="*{star_rating}" class="error-message"></span>
                </div>

                <!-- Testo recensione -->
                <div class="form-group">
                    <label for="text">Recensione *</label>
                    <textarea id="text" th:field="*{text}" 
                              placeholder="Condividi la tua esperienza con questo orologio..."
                              rows="6" required></textarea>
                    <span th:if="${#fields.hasErrors('text')}" 
                          th:errors="*{text}" class="error-message"></span>
                    <div class="form-hint">
                        <span class="char-count" id="charCount">0</span> caratteri (minimo 10)
                    </div>
                </div>

                <!-- Pulsanti -->
                <div class="form-actions">
                    <button type="submit" class="btn-save-changes">
                        Salva Modifiche
                    </button>
                    <a th:href="@{/watch/{id}/reviews(id=${review.watch.id})}" class="btn-cancel-edit">
                        Annulla
                    </a>
                </div>
            </form>
        </div>

        <!-- Informazioni recensione -->
        <div class="review-info">
            <div class="info-item">
                <span class="info-label">Creata il:</span>
                <span class="info-value" th:text="${#temporals.format(review.createdAt, 'dd MMMM yyyy HH:mm')}">Data</span>
            </div>
        </div>
    </div>

</body>
</html>